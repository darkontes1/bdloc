<?php

namespace AppBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * BookRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class BookRepository extends EntityRepository
{
    public function allResults()
    {
        $qd=$this->createQueryBuilder('b');
        $qd->select('b','a','c','s')
        ->leftJoin('b.dessinateur', 'a')
        ->leftJoin('b.scenariste', 'c')
        ->leftJoin('b.coloriste', 's');
        $query=$qd->getQuery();
        $query->setMaxResults(10);
        $result=$query->getResult();

        return $result;
    }

    public function cateResult($cate=null, $exem=null, $mc=null)
    {
        $qd=$this->createQueryBuilder('b');

        $qd->select('b','a','c','s','se')
        ->leftJoin('b.dessinateur', 'a')
        ->leftJoin('b.scenariste', 'c')
        ->leftJoin('b.coloriste', 's')
        ->leftJoin('b.serie','se');

        if($cate != null){
            $qd->andwhere('se.style = '.$cate);
        }

        if($exem != null){
            $qd->andwhere('b.exemplaires = '.$exem);
        }

        if($mc != null){
            $qd->andwhere('b.title = '.$mc);
        }
        
        $query=$qd->getQuery();
        $query->setMaxResults(10);
        $result=$query->getResult();

        return $result;
    }
}
